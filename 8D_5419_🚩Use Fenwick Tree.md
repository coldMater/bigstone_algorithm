Try solving it using a Fenwick tree.
