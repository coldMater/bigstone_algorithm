Luckily, the first attempt was successful. However, the lines of code are too long, and inevitably, there is a 2D array copying with every function call.

It seems necessary to attempt another approach to simplify this.
